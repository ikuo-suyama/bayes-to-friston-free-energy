# Jensenの不等式の直感的理解

**Jensenの不等式は「凸関数のグラフと、それを結ぶ直線（弦）の上下関係」を、平均という操作で言い換えた定理である。**
重みは確率ではない。**位置（どの点を見るか）を指定しているだけ**である。

## 凸関数の本質

関数 $${{f}}$$ が凸であるとは、**任意の2点を結ぶ直線（弦）が、グラフの上にある**ことをいう。
これは形の主張であり、増減とは無関係である。

数式：

$$
f(\lambda x+(1-\lambda)y)\le \lambda f(x)+(1-\lambda)f(y)\quad(0\le\lambda\le1)
$$

![Jensenの不等式の幾何学的直感](images/Jensen.png)

上の図は、凸関数 $${{f(x) = -\log x}}$$ において、2点 $${{(a, f(a))}}$$ と $${{(b, f(b))}}$$ を結ぶ弦（赤い点線）が、その間のグラフ（黒い曲線）より常に上にあることを示している。重み付き平均の点 $${{\lambda a + (1-\lambda)b}}$$ における関数値 $${{f(\lambda a + (1-\lambda)b)}}$$ は、弦の高さ $${{\lambda f(a) + (1-\lambda)f(b)}}$$ 以下になる。これがJensenの不等式の幾何学的な意味である。

## 二階微分による十分条件

$${{f}}$$ が区間で2回微分可能で

$$
\frac{d^2 f}{dx^2}\ge 0
$$

なら、その区間で $${{f}}$$ は凸である。

意味は明確である。
**傾きが右に行くほど増える → 直線より下に曲がる。**

## Jensenが比較している2つの量

Jensenは同じ横位置で、次の2つを比べる。

- **左辺**：グラフ上の点
  $$
  f(\lambda x+(1-\lambda)y)
  $$
- **右辺**：弦上の点
  $$
  \lambda f(x)+(1-\lambda)f(y)
  $$

凸である限り、**グラフ ≤ 弦** が全ての $${{\lambda}}$$ で同時に成立する。

## 重みの正体

$${{\lambda}}$$ は確率ではない。
**弦のどの位置を見るかを指定する比率**である。

- $${{\lambda=0,1}}$$：端点
- $${{\lambda=\tfrac{1}{2}}}$$：弦の中点
- その他：端点間の任意の位置

したがって

$$
\lambda f(x)+(1-\lambda)f(y)
$$

は「足し算」ではなく、**弦上の高さの指定**である。

## なぜ右辺は常に上に来るのか

右辺は**最初から弦の上**を走っている。
左辺は**グラフの上**を走っている。

凸性は

> **グラフが弦を突き抜けない**
> という制約である。

この制約は点ごとに成立するため、**どの重みでも壊れない**。

## 平均・期待値への拡張

有限個の重み付き平均は、弦上の点をさらに弦で混ぜたもの（凸結合）である。
期待値は、その極限である。

形は変わらない。
したがって

$$
f(\mathbb{E}[X])\le \mathbb{E}[f(X)]
$$

が成り立つ。

## 一行で固定

> **Jensenの不等式は、凸なグラフと直線の上下関係を、平均という操作で表現したものにすぎない。**

## 注意点・例外

- 重みは **非負・総和1**（弦・凸結合の条件）
- 凸でない関数では成立しない
- 期待値版では可測性・積分可能性が前提（厳密には専門家に確認が必要）

## 出典

- Jensen, J. L. W. V. (1906), _Sur les fonctions convexes_（一次文献）
- Rockafellar, _Convex Analysis_
- Boyd & Vandenberghe, _Convex Optimization_

## 更新履歴

### 初版
- 2026-01-21: Jensenの不等式の直感的理解を追加
